import{r as a,j as e,S as q,y as L}from"./app-BRf5toWG.js";import{F as u}from"./index.es-BtTm-lQZ.js";import{aA as J,aB as K,l as Q,n as Z}from"./index-BhJBT7_l.js";import{o as W}from"./index-B2KZh1O9.js";import{l as X}from"./index-DHNuJBZz.js";import{F as h}from"./flex-DKwlgr-O.js";import{F as j,c as Y}from"./use-form-control-DHIsxYm4.js";import{F as g}from"./form-label-DWu6OXKn.js";import{I as n}from"./input-DQBKHLse.js";import{B as o}from"./button-Dm7yfw5z.js";import{I as z}from"./input-group-e4ltzjDZ.js";import{I as _}from"./input-addon-fzb-K6CY.js";import{B as S}from"./box-BqPd-jnX.js";import{H as I}from"./heading-D-CUm6-X.js";import{B as p}from"./badge-BWvN93--.js";import"./use-merge-refs-CHqHjQ4S.js";import"./attr-sHTFgF0E.js";import"./call-all-DDzecCnU.js";import"./children-BMP1hdK-.js";const je=({newLinkStatus:l,changeViewActive:T,userActive:F})=>{const[y,k]=a.useState(null),[t,c]=a.useState({idUserActive:0,newUrl:"",alias:"",title:""}),[x,B]=a.useState(F),[d,D]=a.useState(0),[N,U]=a.useState(null),[H,C]=a.useState(!1),[m,A]=a.useState(!1),v=()=>{D(s=>s===2?0:(s===0&&P(`/usl/proxy/data?url=${t.newUrl}`),s+1))},E=s=>{const i=/^(ftp|http|https):\/\/[^ "]+$/.test(s);s.length<1?k(null):k(i)};function f(s){const r=s.target.id;let i=s.target.value,b="";r==="newUrl"&&E(i),r==="alias"&&(b=i.replace(/[^a-zA-Z0-9-/.]/g,""),i=b),c(w=>({...w,[r]:i}))}const G=()=>{switch(y){case!0:return e.jsx(p,{colorScheme:"green",children:"Valid"});case!1:return e.jsx(p,{colorScheme:"red",children:"Tidak Valid"})}},M=()=>{switch(N){case!0:return e.jsx(p,{colorScheme:"red",children:"Link sudah digunakan"});case!1:return e.jsx(p,{colorScheme:"green",children:"Tersedia"})}},V=s=>{s.preventDefault(),L.post("/usl/checkAvailability",t)},O=s=>{s.preventDefault(),L.post("/usl/createNew",t),v()},P=s=>{fetch(s).then(r=>r.text()).then(r=>{const w=new DOMParser().parseFromString(r,"text/html").querySelector("title").textContent;c(R=>({idUserActive:x===null?0:x[0],newUrl:R.newUrl,alias:R.alias,title:w})),C(!0)}).catch(r=>{c(i=>({idUserActive:x[0],newUrl:i.newUrl,alias:i.alias,title:"UNUSIDA Link"})),C(!0),console.error("Error fetching the URL:",r)})},$=a.useCallback(()=>{U(l)},[l]);return a.useEffect(()=>{$()},[l]),a.useEffect(()=>{U(null),axios.post("/usl/get-user-active",{id:0}).then(function(s){c(r=>({idUserActive:s.data[0].idUserActive,newUrl:"",alias:"",title:""})),B(s.data[1])}).catch(function(s){})},[]),e.jsxs(h,{direction:"column",alignItems:"flex-end",my:3,px:3,py:2,boxShadow:"base",borderRadius:"6px",bg:"white",children:[e.jsxs(j,{children:[e.jsxs(g,{children:["Url Tujuan  ",G()]}),e.jsx(n,{size:["sm","sm","md"],borderRadius:"6px",value:t.newUrl,onChange:f,id:"newUrl",isDisabled:d!==0,placeholder:"https://www.youtube.com/watch?v=QloMdg2bapw",style:{userSelect:"none !important"}}),e.jsx(Y,{children:"Masukan URL panjang disini"})]}),e.jsxs(o,{onClick:v,borderRadius:"6px",mt:1,width:"max-content",size:["sm","sm","md"],colorScheme:"blue",display:d===0?"block":"none",isDisabled:t.newUrl.length<10||y===!1,children:["Simpan  ",e.jsx(u,{icon:J})]}),d===1?e.jsxs(e.Fragment,{children:[e.jsxs(h,{as:"form",direction:"column",alignItems:"flex-end",width:"100%",onSubmit:V,children:[e.jsxs(j,{mt:2,children:[e.jsxs(g,{children:["Judul URL  ",H===!1?e.jsx(q,{color:"green.500",size:"sm"}):""]}),e.jsx(z,{size:["sm","sm","md"],pb:1,children:e.jsx(n,{size:["sm","sm","md"],value:t.title,onChange:f,id:"title",placeholder:"judul url",borderRadius:"6px"})})]}),e.jsxs(j,{mt:2,children:[e.jsxs(g,{children:["Masukan Custom Link ",M()]}),e.jsxs(z,{size:["sm","sm","md"],pb:1,children:[e.jsx(_,{borderBottomLeftRadius:"6px",borderTopLefttRadius:"6px",children:"https://unusida.id/"}),e.jsx(n,{size:["sm","sm","md"],value:t.alias,onChange:f,id:"alias",placeholder:"customlink",borderRadius:"6px"})]})]}),e.jsxs(o,{type:"submit",mt:1,borderRadius:"6px",width:"max-content",size:["sm","sm","md"],colorScheme:"blue",isDisabled:t.alias.length<3,children:[e.jsx(u,{icon:K}),"  Cek Ketersediaan"]})]}),l===!1?e.jsx(S,{as:"form",onSubmit:O,children:e.jsxs(o,{type:"submit",mt:1,borderRadius:"6px",width:"max-content",size:["sm","sm","md"],colorScheme:"green",isDisabled:l!==!1,children:[e.jsx(u,{icon:Q}),"  Buat Link"]})}):""]}):"",d===2?e.jsxs(h,{width:"100%",mt:3,border:"2px",borderColor:"gray.200",justifyContent:"space-between",borderRadius:"6px",overflow:"hidden",bg:"gray.100",direction:["column","column","row"],children:[e.jsxs(S,{bg:"white",mr:[0,0,1],px:2,py:3,boxShadow:"base",flexGrow:1,children:[e.jsx(I,{as:"h3",mb:1,color:"gray.600",fontSize:"md",children:"Link Awal"}),e.jsx(n,{size:["sm","sm","md"],borderRadius:"0px",variant:"filled",userSelect:"none",placeholder:"Link Awal...",value:t.newUrl,isDisabled:!0,style:{userSelect:"none !important"}})]}),e.jsxs(S,{bg:"white",ml:[0,0,1],px:2,py:3,boxShadow:"base",flexGrow:1,children:[e.jsx(I,{as:"h3",mb:1,color:"gray.600",fontSize:"md",children:"Link Hasil Shorten"}),e.jsx(n,{size:["sm","sm","md"],borderRadius:"6px",variant:"filled",placeholder:"Link Hasil...",userSelect:"none",value:"https://unusida.id/"+t.alias,isReadOnly:!0,style:{userSelect:"none !important"}}),e.jsxs(h,{mt:3,width:"100%",justifyContent:"flex-end",direction:"row",children:[e.jsx(o,{onClick:()=>{T(0)},colorScheme:"purple",mr:2,size:["sm","sm","md"],children:"Lihat History"}),e.jsx(X.CopyToClipboard,{text:"https://unusida.id/"+t.alias,onCopy:()=>{A(!0),setTimeout(()=>{A(!1)},3e3)},children:e.jsxs(o,{colorScheme:m?"green":"yellow",size:["sm","sm","md"],children:[m?"Disalin":"Salin","  ",e.jsx(u,{bounce:m,icon:m?Z:W})]})})]})]})]}):""]})};export{je as default};
