import{r as a,b as f,j as r,S as _t}from"./app-BRf5toWG.js";import{s as St}from"./index-BhJBT7_l.js";import{F as N}from"./index.es-BtTm-lQZ.js";import Dt from"./KinerjaTable-B-f5GKyJ.js";import{f as xt}from"./index-B2KZh1O9.js";import jt from"./KinerjaHistory-C2N2fpzP.js";import{h as bt}from"./moment-C5S46NFB.js";import yt from"./ScoutModeMain-BQcQXXvp.js";import Mt from"./DemoAdjustDate-qfHdwm4M.js";import{u as Tt}from"./use-toast-Mdy3JCFw.js";import{F as x}from"./flex-DKwlgr-O.js";import{T as wt}from"./text-CdRbiz2-.js";import{T as It,a as Pt,b as z,c as Et,d as U}from"./tab-panels-l5wUlukS.js";import{B as J}from"./badge-BWvN93--.js";import"./TaskEmpty-C4FCZc1F.js";import"./box-BqPd-jnX.js";import"./input-DQBKHLse.js";import"./use-form-control-DHIsxYm4.js";import"./use-merge-refs-CHqHjQ4S.js";import"./attr-sHTFgF0E.js";import"./call-all-DDzecCnU.js";import"./select-DiJvIInU.js";import"./ActiveUserTask-JZTzpAED.js";import"./TaskItem-DQlpCNyP.js";import"./TaskChildItem-DTu3bAnm.js";import"./alert-dialog-C8VgP9bi.js";import"./modal-overlay-BIVDhjzn.js";import"./typeof-BVQB8lKn.js";import"./button-Dm7yfw5z.js";import"./use-disclosure-B8l4uvt7.js";import"./TaskChildEmpty-1l7DWmf9.js";import"./AssignerTaskSymbol-77Jur8Yy.js";import"./circular-progress-By2wHYQi.js";import"./use-boolean-DWsdq_aC.js";import"./TaskItemKosong-Ce4Kqc4W.js";import"./AssignerColorInfo-BaLCesH5.js";import"./OtherUserTask-BmTrrmJR.js";import"./HistoryPerUser-KF49VoGM.js";import"./HistoryTaskItem-DjLwga2e.js";import"./HistoryTaskChildItem-DunXsuL4.js";import"./TotalPercentage-a_8_4xyt.js";import"./TopHead-BzHE1Prr.js";import"./DateTools-DazUeWyn.js";import"./children-BMP1hdK-.js";S(),S(),S(),S(),S(),S(),S(),S(),S();const Ft=(i,u)=>{const t=[];let o=new Date(i);for(let d=0;d<u;d++){const _=o.getFullYear(),l=o.getMonth()+1,m=l<10?`0${l}`:`${l}`,D=`${_}-${m}-01`;t.push(D),o.setMonth(o.getMonth()+1)}return t};function At(i,u){const t=new Date(i),o=new Date(u),d=t.getFullYear(),_=t.getMonth(),l=o.getFullYear(),m=o.getMonth();return(l-d)*12+(m-_)}function Y(i){const u=new Date(i),t=u.getDate();u.getMonth()+1;let o=null,d=null,_=null,l=null,m=null,D=null,p=null,b=null;if(t<20){const g=new Date(u);g.setMonth(g.getMonth()-1),g.setDate(20),o=g.toISOString().slice(0,10),_=g.getMonth(),m=g.getDate(),p=g.getFullYear();const c=new Date(u);c.setDate(19),d=c.toISOString().slice(0,10),l=c.getMonth(),D=c.getDate(),b=c.getFullYear()}else{const g=new Date(u);g.setDate(20),o=g.toISOString().slice(0,10),_=g.getMonth(),m=g.getDate(),p=g.getFullYear();const c=new Date(u);c.setMonth(c.getMonth()+1),c.setDate(19),d=c.toISOString().slice(0,10),l=c.getMonth(),D=c.getDate(),b=c.getFullYear()}return[o,d,_,l,m,D,p,b]}function Ot(i){const u=JSON.stringify(i);return JSON.parse(u)}function Yt(i){return Object.assign({},i)}function S(){const i=new Date,u=i.getFullYear();let t=i.getMonth()+1,o=i.getDate();return t<10&&(t="0"+t),o<10&&(o="0"+o),u+"-"+t+"-"+o}function Lt(i){const[u,t,o]=i.split("-").map(Number),d=new Date(u,t-1,o);d.setMonth(d.getMonth()+1);const _=d.getFullYear(),l=d.getMonth()+1,m=d.getDate();return`${_}-${l.toString().padStart(2,"0")}-${m.toString().padStart(2,"0")}`}function Te({mainTheme:i,listAssigneKinerja:u,activeBio:t,auth:o,userType:d,globalDosenMod:_}){const[l,m]=a.useState([]),[D,p]=a.useState(null),[b,g]=a.useState(!1),[c,R]=a.useState([]),L=Tt(),E=a.useRef(),[w,I]=a.useState(!0),[F,H]=a.useState(null);a.useState(0);const[G,P]=a.useState(!1),[h,V]=a.useState(bt().format("YYYY-MM-DD")),[C,W]=a.useState(!1),[q,Q]=a.useState(!1),[X,Z]=a.useState([]),[v,B]=a.useState("2014-11-11"),[tt,et]=a.useState(""),[st,nt]=a.useState("2014-11-11"),[at,rt]=a.useState(""),A=()=>{const s=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],e=Y(h);let n=e[0],M=e[1],T=`${e[4]} ${s[e[2]]} ${e[6]}`,K=`${e[5]} ${s[e[3]]} ${e[7]}`;B(n),nt(M),et(T),rt(K)},[$,O]=a.useState([]);a.useState(!0),a.useState({defaultStatus:2,fullname:"User",jabatan:"Default",username:"default",statusKepegawaian:"Default"});const y=(s="update",e="warning",n=r.jsx(x,{alignItems:"center",height:"100%",children:r.jsx(N,{icon:xt})}))=>{E.current&&L.update(E.current,{title:s,status:e,icon:n})},ot=()=>{W(s=>!s)},k=(s="success",e="notification")=>{E.current=L({title:e,status:s,duration:9e3,isClosable:!0,position:"bottom-left"})};function it(s){const e=Array.from(l);k("warning","Tunggu..."),f.post("/sik/create-new-task-dosen",s,{headers:{"Content-Type":"application/json"}}).then(function(n){if(n.data.good)return f.post("/sik/get-assigne-name-dosen",{id:t.unit_id,userId:t.id,struktural_dosen_id:t.jabatan_strukdos_id,fakultas_id:t.fakultas_id,customDate:h})}).then(function(n){p(n.data.userTask),y("Berhasil disimpan!","info")}).catch(function(n){k("warning","Terjadi Kesalahan!")}),g(!1),e.push(s),m(e)}function dt(s){const e=Array.from(l);let n=Ot(e[s]);n.active=!n.active,e.splice(s,1,n),m(e)}const ut=(s,e)=>{Yt(l[e]),k("warning","Tunggu..."),f.post("/sik/create-sub-task-dosen",s).then(function(n){if(n.data.good)return f.post("/sik/get-assigne-name-dosen",{id:t.unit_id,userId:t.id,struktural_dosen_id:t.jabatan_strukdos_id,fakultas_id:t.fakultas_id,customDate:h})}).then(function(n){p(n.data.userTask),y("Berhasil disimpan!","info")}).catch(function(n){k("warning","Terjadi Kesalahan!")})},lt=(s,e)=>{k("success","Sedang mengubah..."),f.post("/sik/update-sub-task",e).then(function(n){if(n.data.good)return f.post("/sik/get-assigne-name-dosen",{id:t.unit_id,userId:t.id,struktural_dosen_id:t.jabatan_strukdos_id,fakultas_id:t.fakultas_id,customDate:h})}).then(function(n){p(n.data.userTask),y("Berhasil disimpan!","info")}).catch(function(n){k("warning","Terjadi Kesalahan!")})},ct=(s,e)=>{k("success","Tunggu..."),f.post("/sik/delete-sub-task",{id:s,taskId:e}).then(function(n){if(n.data.good)return f.post("/sik/get-assigne-name-dosen",{id:t.unit_id,userId:t.id,struktural_dosen_id:t.jabatan_strukdos_id,fakultas_id:t.fakultas_id,customDate:h})}).then(function(n){p(n.data.userTask),y("Berhasil dihapus!","info")}).catch(function(n){k("warning","Terjadi Kesalahan!")})};function ft(s){const e=Array.from(l);e.splice(s,1),m(e)}function gt(s){k("success","Tunggu..."),f.post("/sik/delete-task",{id:s}).then(function(e){if(e.data.deleteSuccess)return f.post("/sik/get-assigne-name-dosen",{id:t.unit_id,userId:t.id,struktural_dosen_id:t.jabatan_strukdos_id,fakultas_id:t.fakultas_id,customDate:h})}).then(function(e){p(e.data.userTask),y("Berhasil dihapus!","info")}).catch(function(e){k("warning","Terjadi Kesalahan!")})}const mt=(s,e)=>{s.preventDefault()},pt=()=>{f.post("/sik/get-task-history",{id:t.unit_id,userId:t.id,struktural_dosen_id:t.jabatan_strukdos_id,fakultas_id:t.fakultas_id,customDate:h}).then(function(s){O(s.data.userTask)}).catch(function(s){})},ht=s=>{const e=s.target.value;V(e),A(),f.post("/sik/get-assigne-name-dosen",{id:t.unit_id,userId:t.id,struktural_dosen_id:t.jabatan_strukdos_id,fakultas_id:t.fakultas_id,customDate:e}).then(function(n){p(n.data.userTask)}).catch(function(n){}),f.post("/sik/get-task-history",{id:t.unit_id,userId:t.id,struktural_dosen_id:t.jabatan_strukdos_id,fakultas_id:t.fakultas_id,customDate:h}).then(function(n){O(n.data.userTask)}).catch(function(n){})};a.useEffect(()=>{A()},[t]),a.useEffect(()=>{const s=["adminsdmunusida"];d<=1||s.includes(o.user.username)?d!==null?(P(!0),I(!1)):P(null):(P(!1),d!==null&&(f.post("/sik/get-assigne-name-dosen",{id:t.unit_id,userId:t.id,struktural_dosen_id:t.jabatan_strukdos_id,fakultas_id:t.fakultas_id}).then(function(e){p(e.data.userTask),R(e.data.assigneList),I(!1)}).catch(function(e){}),f.post("/sik/get-user-additional-info",{struktural_dosen_id:t.jabatan_strukdos_id,fakultas_id:t.fakultas_id}).then(function(e){H(parseInt(e.data.jabatan_level))}).catch(function(e){})))},[d]),a.useEffect(()=>{A()},[D]),a.useEffect(()=>{o&&o.user.username==="adminsdmunusida"&&P(!0);const s="2024-01-01",e=S(),n=At(s,e);let M=[],T=Ft(s,n+1);for(let j=0;j<=n;j++)M.push(Y(T[j]));parseInt(new Date().getDate())>19&&M.push(Y(Lt(T[T.length-1]))),Z(M),f.post("/sik/get-demo-status",{id:0}).then(function(j){Q(j.data.demoStatus)}).catch(function(j){})},[]);function kt(s){}return a.useEffect(()=>{},[]),a.useEffect(()=>{},[w]),a.useEffect(()=>{f.post("/sik/get-assigne-name-dosen",{id:t.unit_id,userId:t.id,struktural_dosen_id:t.jabatan_strukdos_id,fakultas_id:t.fakultas_id,customDate:h}).then(function(s){}).catch(function(s){})},[]),r.jsx(r.Fragment,{children:w?r.jsxs(x,{height:"200px",alignItems:"center",width:"100%",justifyContent:"center",direction:"column",children:[r.jsx(wt,{size:"18px",mb:3,color:"gray.600",children:"Memuat..."}),r.jsx(_t,{thickness:"4px",speed:"0.35s",emptyColor:"gray.200",color:"gray.600",size:"md"})]}):r.jsxs(x,{position:"relative",width:"100%",height:"max-content",borderRadius:"10px",direction:"column",boxSizing:"border-box",className:"hide-scrbar",children:[q?r.jsx(x,{position:"fixed",right:C?"0px":"-225px",zIndex:20,boxShadow:"lg",alignSelf:"flex-end",width:"250px",transition:"250ms ease-out",children:r.jsx(Mt,{showDateAdjust:C,customDate:h,reloadWithNewDate:ht,mainTheme:i,toggleDateAdjust:ot,setIsLoading:I})}):"",G?r.jsx(yt,{mainTheme:i,listAssigne:c,taskList:$,userActiveLevel:F,activeBio:t,periodeList:X,setIsLoading:I,isLoading:w}):r.jsxs(It,{align:"end",variant:"soft-rounded",colorScheme:"green",children:[r.jsxs(Pt,{display:"flex",bg:"white",py:2,px:1,borderRadius:"6px",flexDirection:["column","column","column","row"],children:[r.jsxs(x,{fontSize:"13px",alignItems:"flex-start",px:3,width:"100%",direction:"column",children:[r.jsxs(x,{color:"gray.500",alignItems:"center",children:["Periode Â ",r.jsx(N,{icon:St})]}),r.jsxs(x,{color:"gray.500",children:[r.jsx(J,{colorScheme:"gray",mr:2,children:tt})," ","ke"," ",r.jsx(J,{colorScheme:"gray",ml:2,children:at})]})]}),r.jsxs(x,{px:[3,3,3,0],pt:[3,3,3,0],children:[r.jsx(z,{children:"Dosen Task"}),r.jsx(z,{onClick:pt,children:"History"})]})]}),r.jsxs(Et,{children:[r.jsx(U,{px:0,children:r.jsx(Dt,{updateKinerjaPeriodeTask:kt,customDate:h,callMyToast:k,userActiveLevel:F,isLoading:w,deleteFromDB:gt,activeBio:t,listAssigne:c,allUserTaskList:D,deleteChildToParent:ct,addChildToParent:ut,deleteTask:ft,addNewTask:it,saveData:mt,setShowEmptyTask:g,showEmptyTask:b,toggleSelectedDisableItem:dt,userTaskList:l,mainTheme:i,updateSubTask:lt,periodeDate:[v,st]})}),r.jsx(U,{px:0,children:r.jsx(jt,{listAssigne:c,historyList:$,setHistoryList:O,userActiveLevel:F,activeBio:t,mainTheme:i})})]})]})]})})}export{Te as default};
