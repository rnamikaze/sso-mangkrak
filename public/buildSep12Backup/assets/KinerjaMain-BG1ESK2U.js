import{r,j as a,S as ft,b as i}from"./app-D-tiouko.js";import{s as gt}from"./index-BLEpFBfl.js";import{F as O}from"./index.es-B8LRRmtI.js";import ht from"./KinerjaTable-DAVQM6Yc.js";import{f as xt}from"./index-B2KZh1O9.js";import kt from"./HistoryPerUser-CZEwCV6p.js";import{h as jt}from"./moment-C5S46NFB.js";import bt from"./ScoutModeMain-DZnhFWOG.js";import _t from"./DemoAdjustDate-u7Uee4J_.js";import{a as H,b as St,s as C}from"./DateTools-DazUeWyn.js";import{$ as Tt}from"./module-CYFofynI.js";import{u as yt}from"./use-toast-cYYc5Dzw.js";import{F as o}from"./flex-B3u7Yjy3.js";import{T as Dt}from"./text-B41xTBOs.js";import{T as It,a as wt,b as $,c as Ct,d as G}from"./tab-panels-7f1vUtT0.js";import{B as J}from"./badge-vqBRhT-u.js";import{S as Lt}from"./select-BZQ40FW4.js";import"./TaskEmpty-Dv55UB2Q.js";import"./box-B4e4n_hZ.js";import"./input-DQdjWTTb.js";import"./use-form-control-CwhKtZKy.js";import"./use-merge-refs-BFB3bSvN.js";import"./attr-sHTFgF0E.js";import"./call-all-DDzecCnU.js";import"./ActiveUserTask-DwwViaCK.js";import"./TaskItem-DZ1UREOw.js";import"./TaskChildItem-BPrQaT05.js";import"./alert-dialog-CrzKKWCS.js";import"./modal-overlay-BoBZIlNT.js";import"./typeof-BVQB8lKn.js";import"./button-b_OXMfTF.js";import"./use-disclosure-BEJBEFUx.js";import"./TaskChildEmpty-B_b3DY1u.js";import"./AssignerTaskSymbol-b-AfNNF2.js";import"./circular-progress-CsYzCqAF.js";import"./use-boolean-D4otBCAS.js";import"./TaskItemKosong-BkWY7Lru.js";import"./AssignerColorInfo-OoAPEizV.js";import"./OtherUserTask-C6UR8qlP.js";import"./HistoryTaskItem-y1HfPr2Y.js";import"./HistoryTaskChildItem-DnOJmrUt.js";import"./TotalPercentage-CzXI8s9e.js";import"./TopHead-B8j0ISMT.js";import"./KinerjaHistory-BuBtCoNV.js";import"./children-CpoAimTO.js";c(),c(),c(),c(),c(),c(),c(),c(),c();function At(d){const j=JSON.stringify(d);return JSON.parse(j)}function Pt(d){return Object.assign({},d)}function c(){const d=new Date,j=d.getFullYear();let s=d.getMonth()+1,p=d.getDate();return s<10&&(s="0"+s),p<10&&(p="0"+p),j+"-"+s+"-"+p}const ye=({mainTheme:d,listAssigneKinerja:j,activeBio:s,auth:p,userType:g,globalDosenMod:V})=>{const[h,_]=r.useState([]),[W,m]=r.useState(null),[q,L]=r.useState(!1),[l,A]=r.useState(null),[S,T]=r.useState([]),P=yt(),y=r.useRef(),[D,x]=r.useState(!0),[I,Q]=r.useState(null);r.useState(0);const[M,b]=r.useState(!1),[f,X]=r.useState(jt().format("YYYY-MM-DD")),[z,Z]=r.useState(!1),[v,Mt]=r.useState(!1),[w,B]=r.useState([]);r.useState("2014-11-11"),r.useState(""),r.useState("2014-11-11"),r.useState(""),r.useState(null),r.useState(null);const[E,tt]=r.useState(0),[K,F]=r.useState(!1),et=t=>{A(H(new Date(C(t.target.value)[0])))},[U,R]=r.useState([]);r.useState(!0),r.useState({defaultStatus:2,fullname:"User",jabatan:"Default",username:"default",statusKepegawaian:"Default"});const k=(t="update",n="warning",e=a.jsx(o,{alignItems:"center",height:"100%",children:a.jsx(O,{icon:xt})}))=>{y.current&&P.update(y.current,{title:t,status:n,icon:e})},st=t=>{tt(t)},at=()=>{Z(t=>!t)},u=(t="success",n="notification")=>{y.current=P({title:n,status:t,duration:9e3,isClosable:!0,position:"bottom-left"})};function nt(t){const n=Array.from(h);u("warning","Tunggu..."),i.post("/sik/create-new-task",t,{headers:{"Content-Type":"application/json"}}).then(function(e){if(e.data.good)return i.post("/sik/get-assigne-name",{id:s.unit_id,userId:s.id,struktural_id:s.jabatan_struktural_id,customDate:f})}).then(function(e){m(e.data.userTask),k("Berhasil disimpan!","info")}).catch(function(e){u("warning","Terjadi Kesalahan!")}),L(!1),n.push(t),_(n)}function rt(t){const n=Array.from(h);let e=At(n[t]);e.active=!e.active,n.splice(t,1,e),_(n)}const it=(t,n)=>{Pt(h[n]),u("warning","Tunggu..."),i.post("/sik/create-sub-task",t).then(function(e){if(e.data.good)return i.post("/sik/get-assigne-name",{id:s.unit_id,userId:s.id,struktural_id:s.jabatan_struktural_id,customDate:f})}).then(function(e){m(e.data.userTask),k("Berhasil disimpan!","info")}).catch(function(e){u("warning","Terjadi Kesalahan!")})},ot=(t,n)=>{u("success","Sedang mengubah..."),i.post("/sik/update-sub-task",n).then(function(e){if(e.data.good)return i.post("/sik/get-assigne-name",{id:s.unit_id,userId:s.id,struktural_id:s.jabatan_struktural_id,customDate:f})}).then(function(e){m(e.data.userTask),k("Berhasil disimpan!","info")}).catch(function(e){u("warning","Terjadi Kesalahan!")})},ut=(t,n)=>{u("success","Tunggu..."),i.post("/sik/delete-sub-task",{id:t,taskId:n}).then(function(e){if(e.data.good)return i.post("/sik/get-assigne-name",{id:s.unit_id,userId:s.id,struktural_id:s.jabatan_struktural_id,customDate:f})}).then(function(e){m(e.data.userTask),k("Berhasil dihapus!","info")}).catch(function(e){u("warning","Terjadi Kesalahan!")})};function dt(t){const n=Array.from(h);n.splice(t,1),_(n)}function lt(t){u("success","Tunggu..."),i.post("/sik/delete-task",{id:t}).then(function(n){if(n.data.deleteSuccess)return i.post("/sik/get-assigne-name",{id:s.unit_id,userId:s.id,struktural_id:s.jabatan_struktural_id,customDate:f})}).then(function(n){m(n.data.userTask),k("Berhasil dihapus!","info")}).catch(function(n){u("warning","Terjadi Kesalahan!")})}const ct=(t,n)=>{t.preventDefault()},Y=()=>{F(!0);const t=C(l.value)[0],n=C(l.value)[1];i.post("/sik/get-task-history",{id:s.unit_id,userId:s.id,struktural_id:s.jabatan_struktural_id,startDate:t,endDate:n}).then(function(e){R(e.data.userTask),T(e.data.assigneList),F(!1)}).catch(function(e){})};function pt(t){i.post("/sik/update-periode-task",{task_id:t}).then(function(n){i.post("/sik/get-assigne-name",{id:s.unit_id,userId:s.id,struktural_id:s.jabatan_struktural_id}).then(function(e){m(e.data.userTask),T(e.data.assigneList),x(!1),u("success","Periode Task Diperbarui")}).catch(function(e){u("warning","Gagal Diperbarui")})}).catch(function(n){})}const mt=t=>{const n=t.target.value;X(n),i.post("/sik/get-assigne-name",{id:s.unit_id,userId:s.id,struktural_id:s.jabatan_struktural_id,customDate:n}).then(function(e){m(e.data.userTask)}).catch(function(e){}),i.post("/sik/get-task-history",{id:s.unit_id,userId:s.id,struktural_id:s.jabatan_struktural_id,customDate:f}).then(function(e){R(e.data.userTask)}).catch(function(e){})};r.useEffect(()=>{A(H())},[]);const N=()=>{i.post("/sik/get-assigne-name",{id:s.unit_id,userId:s.id,struktural_id:s.jabatan_struktural_id}).then(function(t){m(t.data.userTask),T(t.data.assigneList),x(!1)}).catch(function(t){}),i.post("/sik/get-user-additional-info",{struktural_id:s.jabatan_struktural_id}).then(function(t){console.log(t.data.jabatan_level),Q(parseInt(t.data.jabatan_level))}).catch(function(t){})};return r.useEffect(()=>{const t=["adminsdmunusida","superadmin"];g<=1||t.includes(p.user.username)?g!==null?(b(!0),x(!1)):b(null):(b(!1),g!==null&&N())},[g]),r.useEffect(()=>{l&&!M&&Y()},[l]),r.useEffect(()=>{p&&p.user.username==="adminsdmunusida"&&b(!0),B(St("12/2024"))},[]),a.jsx(a.Fragment,{children:V?a.jsx(o,{children:"Sedang Perbaikan !"}):a.jsx(a.Fragment,{children:D?a.jsxs(o,{height:"200px",alignItems:"center",width:"100%",justifyContent:"center",direction:"column",children:[a.jsx(Dt,{size:"18px",mb:3,color:"gray.600",children:"Memuat..."}),a.jsx(ft,{thickness:"4px",speed:"0.35s",emptyColor:"gray.200",color:"gray.600",size:"md"})]}):a.jsxs(o,{position:"relative",width:"100%",height:"max-content",borderRadius:"10px",direction:"column",boxSizing:"border-box",className:"hide-scrbar",children:[K?a.jsx(o,{position:"absolute",width:"100%",height:"200px",zIndex:5,justifyContent:"center",alignItems:"flex-end",mt:"100px",children:a.jsxs(o,{px:1,py:1,direction:"column",color:"#2fa24b",alignItems:"center",justifyContent:"center",children:[a.jsx(Tt,{color:"#48bb78",width:"60",visible:!0,ariaLabel:"falling-circles-loading"}),a.jsx(o,{color:"#48bb78",fontWeight:"bold",fontSize:"14px",textAlign:"center",children:"MEMUAT"})]})}):"",v?a.jsx(o,{position:"fixed",right:z?"0px":"-225px",zIndex:20,boxShadow:"lg",alignSelf:"flex-end",width:"250px",transition:"250ms ease-out",children:a.jsx(_t,{showDateAdjust:z,customDate:f,reloadWithNewDate:mt,mainTheme:d,toggleDateAdjust:at,setIsLoading:x})}):"",M?a.jsx(bt,{mainTheme:d,listAssigne:S,taskList:U,userActiveLevel:I,activeBio:s,periodeList:w,setIsLoading:x,isLoading:D}):a.jsxs(It,{align:"end",variant:"soft-rounded",colorScheme:"green",index:E,onChange:st,size:"sm",children:[a.jsxs(wt,{display:"flex",bg:"white",py:2,px:1,borderRadius:"6px",flexDirection:["column","column","column","row"],children:[a.jsxs(o,{fontSize:"13px",alignItems:"flex-start",px:3,width:"100%",direction:"column",children:[a.jsxs(o,{color:"gray.500",alignItems:"center",children:["Periode Â ",a.jsx(O,{icon:gt})]}),a.jsxs(o,{color:"gray.500",children:[a.jsx(J,{colorScheme:"gray",mr:2,children:l.startDate})," ","ke"," ",a.jsx(J,{colorScheme:"gray",ml:2,children:l.endDate})]})]}),E===1?a.jsx(o,{position:"relative",width:"max-content",alignItems:"flex-start",height:"100%",mr:3,direction:"column",px:[3,3,3,0],pt:[2,2,2,0],alignSelf:"center",children:a.jsx(Lt,{width:["100%","100%","100%","max-content"],size:"sm",borderColor:"gray.300",bg:"gray.50",id:"periode_change",onChange:et,value:l.value,defaultValue:w.length-1,borderRadius:"2px",children:w.map(t=>a.jsx("option",{value:t.value,children:t.title},t.id))})}):"",a.jsxs(o,{px:[3,3,3,0],pt:[3,3,3,0],fontSize:["13px","13px","14px","15px"],children:[a.jsx($,{children:"Task"}),a.jsx($,{onClick:Y,children:"History"})]})]}),K?"":a.jsxs(Ct,{children:[a.jsx(G,{px:0,children:a.jsx(ht,{getAssigneName:N,updateKinerjaPeriodeTask:pt,customDate:f,callMyToast:u,userActiveLevel:I,isLoading:D,deleteFromDB:lt,activeBio:s,listAssigne:S,allUserTaskList:W,deleteChildToParent:ut,addChildToParent:it,deleteTask:dt,addNewTask:nt,saveData:ct,setShowEmptyTask:L,showEmptyTask:q,toggleSelectedDisableItem:rt,userTaskList:h,mainTheme:d,updateSubTask:ot,periodeDate:[l.startDate,l.endDate]})}),a.jsx(G,{px:0,children:a.jsx(o,{direction:"column",children:S.map((t,n)=>a.jsx(kt,{callMyToast:null,userActiveLevel:I,deleteFromDB:null,userTaskList:U,mainTheme:d,activeBio:t,deleteChildToParent:null,updateChildToParent:null,addChildToParent:null,deleteTask:null,toggleSelectedDisableItem:null,updateSubTask:null},n))})})]})]})]})})})};export{ye as default};
