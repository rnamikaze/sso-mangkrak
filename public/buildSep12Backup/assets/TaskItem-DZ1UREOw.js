import{r as s,j as e}from"./app-D-tiouko.js";import{F as y}from"./index.es-B8LRRmtI.js";import{o as T,l as R}from"./index-BLEpFBfl.js";import{c as me}from"./index-B2KZh1O9.js";import de from"./TaskChildItem-BPrQaT05.js";import fe from"./TaskChildEmpty-B_b3DY1u.js";import pe from"./AssignerTaskSymbol-b-AfNNF2.js";import{h as o}from"./moment-C5S46NFB.js";import{F as i}from"./flex-B3u7Yjy3.js";import{B as P}from"./box-B4e4n_hZ.js";import{B as ue}from"./badge-vqBRhT-u.js";import{T as xe}from"./text-B41xTBOs.js";import{C as he}from"./circular-progress-CsYzCqAF.js";import{B as u}from"./button-b_OXMfTF.js";import{A as ge,a as be}from"./alert-dialog-CrzKKWCS.js";import{M as Se,b as je,c as ye,d as we}from"./modal-overlay-BoBZIlNT.js";import{u as De}from"./use-boolean-D4otBCAS.js";import{u as Ye}from"./use-disclosure-BEJBEFUx.js";import"./input-DQdjWTTb.js";import"./use-form-control-CwhKtZKy.js";import"./use-merge-refs-BFB3bSvN.js";import"./attr-sHTFgF0E.js";import"./call-all-DDzecCnU.js";import"./select-BZQ40FW4.js";import"./typeof-BVQB8lKn.js";function W(l){return typeof l!="string"?"":l.length<=25?l:l.slice(0,25)+"..."}function Ce(l){const[r]=l.split("T");return r}const st=({getAssigneName:l,mainTheme:r,index:c,task:t=null,setSelected:w,toggleSelectedDisableItem:Ie,selected:x,deleteTask:k,addChildToParent:F,updateChildToParent:G,deleteChildToParent:H,activeBio:O,updateSubTask:K,userActiveLevel:b,callMyToast:D,periodeDate:L,customDate:Y,isDosen:h,updateKinerjaPeriodeTask:V})=>{const[ve,C]=De(!1),[m,I]=s.useState(!1),[n,f]=s.useState(!1),[Me,X]=s.useState(!1),[v,_e]=s.useState(window.innerWidth),[p,N]=s.useState(0),[q,a]=s.useState(h?"#006769":"#48bb78"),[M,J]=s.useState(null),[Q,_]=s.useState(!1),[z,U]=s.useState(0),[Z,A]=s.useState(!1),[S,$]=s.useState([o().format("YYYY-MM-DD"),o().format("YYYY-MM-DD")]),[ze,ee]=s.useState(o().format("YYYY-MM-DD")),[te,B]=s.useState(o().format("YYYY-MM-DD"));s.useState(!1);const{isOpen:se,onOpen:re,onClose:j}=Ye(),E=s.useRef(),ne=d=>{d.key==="Delete"&&(b<=parseInt(t.assigner_level)?re():D("warning","Anda tidak bisa menghapus Task ini."))},oe=()=>p>=65?"blue.400":p>=30?"orange.400":"red.400",ie=s.useCallback(()=>{h?parseInt(t.assigner_level)===0?a("#006769"):parseInt(t.assigner_level)===1?a("#40A578"):parseInt(t.assigner_level)===2?a("#F3CA52"):parseInt(t.assigner_level)===3?a("#5E1675"):parseInt(t.assigner_level)===4?a("#EE4266"):parseInt(t.assigner_level)===5&&a("#E3651D"):t!==null&&(parseInt(t.assigner_level)===2?a("#f56565"):parseInt(t.assigner_level)===3&&a("#4299e1"))},[t]),ae=s.useCallback(()=>{N(t.progress_percentage)},[t]),le=()=>z<3?"red":z<6?"orange":"gray";return s.useEffect(()=>{o().format("YYYY-MM-DD");const d=o(S[1]);o(M===null?Y:M).isAfter(d)?_(!0):_(!1),o().format("YYYY-MM-DD");const ce=o(Y).diff(S[1],"days");U(Math.abs(ce))},[t,S]),s.useEffect(()=>{if(X(t),ae(),ie(),J(t.realize_date),t.progress_percentage>=100?A(!0):A(!1),$(L),t!==null){const g=o(t.latest_date,"YYYY-MM-DD").format("DD/MM/YYYY");ee(Ce(t.created_at)),t.childTask.length>0?B(g):B("-")}},[t]),e.jsxs(i,{direction:"column",mb:1,children:[e.jsxs(i,{bg:x===c?t.is_late?"red.600":"green.600":t.is_late?"red.200":"gray.100",boxShadow:"base",color:x===c?"white":"black",my:1,borderLeft:"0px",borderRight:"0px",fontWeight:x===c?"bold":"inherit",px:3,py:2,onMouseEnter:C.on,onMouseLeave:C.off,transition:"250ms ease-out",cursor:"pointer",onClick:()=>{x===c?(w(null),I(!1)):(w(c),I(!0))},onKeyDown:ne,tabIndex:0,direction:["column","column","column","row"],children:[e.jsx(i,{alignItems:"center",width:["100%","100%","100%","7%"],maxWidth:["100%","100%","100%","7%"],flexGrow:1,color:"gray.500",fontSize:"20px"}),e.jsxs(i,{width:["100%","100%","100%","30%"],maxWidth:["100%","100%","100%","30%"],flexGrow:1,whiteSpace:"wrap",fontSize:["sm","sm","sm","md"],alignItems:"center",children:[e.jsx(pe,{isDosen:h,mainTheme:r,assignerColor:q}),v<480||m?t.title:W(t.title)]}),e.jsxs(i,{width:["100%","100%","100%","30%"],maxWidth:["100%","100%","100%","30%"],flexGrow:1,fontSize:["11px","11px","11px","sm"],px:[0,0,0,1],py:[2,2,2,0],mt:[1,1,1,0],color:m?"whitesmoke":r.heading,children:[e.jsx(P,{display:["inline-block","inline-block","inline-block","none"],style:{transform:"scaleX(-1)",fontSize:"13px",marginRight:"5px",position:"relative",top:"-2px"},children:e.jsx(y,{style:{background:"gray",padding:"5px 5px",borderRadius:"50%",color:"white"},icon:me})}),v<480||m?t.comment:W(t.comment)]}),e.jsx(i,{width:["100%","100%","100%","20%"],maxWidth:["100%","100%","100%","20%"],flexGrow:1,fontSize:["sm","sm","sm","sm"],alignItems:"center",children:Z?e.jsx(ue,{variant:"solid",colorScheme:"blue",children:"Selesai"}):e.jsx(xe,{variant:"outline",bg:"white",px:1,fontSize:"13px",color:Q?"red":le(),children:te})}),e.jsxs(i,{width:["100%","100%","100%","13%"],maxWidth:["100%","100%","100%","13%"],flexGrow:1,fontSize:["sm","sm","sm","md"],mt:[2,2,2,0],alignItems:"center",justifyContent:["flex-end","flex-end","flex-end","flex-start"],children:[e.jsx(P,{display:"inline-flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",width:"max-content",height:"max-content",px:"3px",py:"3px",bg:m?"white":"gray.100",boxShadow:m?"md":"none",children:e.jsx(he,{value:p,size:"22px",thickness:"20px",color:oe(),trackColor:"green.100",capIsRound:!0})}),"  ",p,"%"]})]}),m?e.jsxs(e.Fragment,{children:[e.jsx(i,{display:n?"none":"flex",ml:["0%","0%","0%","7%"],mt:1,px:3,children:t.is_validated===!0?"":e.jsxs(e.Fragment,{children:[e.jsxs(u,{size:"sm",variant:"link",colorScheme:n?r.btnScheme.danger:r.btnScheme.primary,onClick:()=>{f(!n)},children:[n?"Tutup":"Buat Sub Task"," "," ",e.jsx(y,{icon:n?T:R})]}),t.is_late?e.jsx(u,{variant:"link",colorScheme:r.btnScheme.danger,size:"sm",fontSize:"14px",ml:4,onClick:()=>{V(t.id)},children:"Perbarui Periode"}):""]})}),t.childTask.map((d,g)=>e.jsx(de,{percentage:p,userActiveLevel:b,callMyToast:D,deleteChildToParent:H,updateChildToParent:G,task:d,index:c,mainTheme:r,updateSubTask:K,isDosen:h,isValidated:t.is_validated===!0},g)),n?e.jsxs(e.Fragment,{children:[e.jsx(fe,{userActiveLevel:b,activeBio:O,taskId:t.id,addChildToParent:F,mainTheme:r,index:c,setShowTaskEmpty:f}),e.jsx(i,{ml:["0%","0%","0%","7%"],mt:1,px:3,children:e.jsxs(u,{size:"sm",variant:"link",colorScheme:n?r.btnScheme.danger:r.btnScheme.primary,onClick:()=>{f(!n)},children:[n?"Tutup":"Buat Sub Task"," "," ",e.jsx(y,{icon:n?T:R})]})})]}):"",e.jsx(i,{borderBottom:"5px",borderStyle:"double",borderColor:"gray.200",mt:2,boxShadow:"md"})]}):"",e.jsx(ge,{isOpen:se,leastDestructiveRef:E,onClose:j,children:e.jsx(Se,{display:"flex",alignItems:"center",children:e.jsxs(be,{width:["85vw","85vw","inherit","inherit"],children:[e.jsx(je,{fontSize:"md",fontWeight:"bold",children:"Hapus Tugas?"}),e.jsx(ye,{fontSize:"sm",children:"Setelah Menghapus, anda tidak bisa mengembalikannya."}),e.jsxs(we,{children:[e.jsx(u,{size:"sm",ref:E,onClick:j,children:"Batal"}),e.jsx(u,{size:"sm",colorScheme:"red",onClick:()=>{k(t.id),j()},ml:3,children:"Hapus"})]})]})})})]})};export{st as default};
